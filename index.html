<!DOCTYPE html>
<html lang="sq">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Formular Kontakti â€” Landscape</title>
  <style>
    :root{
      --accent:#ced998; --accent-2:#b8c480;
      --ink:#1b1f22; --muted:#5b6368;
      --bg:#f7f9f3; --card:#ffffff; --stroke:#e3ebcc;
      --radius:12px; --shadow:0 10px 24px rgba(0,0,0,.08);
    }
    *{ box-sizing:border-box; }

    body{
      margin:0; padding:40px;
      background: radial-gradient(700px 500px at 10% 0%, rgba(206,217,152,.25), transparent 60%),
                  radial-gradient(700px 500px at 100% 100%, rgba(184,196,128,.18), transparent 60%),
                  var(--bg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--ink); display:flex; justify-content:center;
    }

    /* ===== LANDSCAPE LAYOUT (dy kolona fikse) ===== */
    form#contact-form{
      width:min(920px,100%);
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:16px;
      box-shadow:var(--shadow);
      padding:28px;
      display:grid;
      grid-template-columns: 1fr 1fr;   /* dy kolona â€“ gjithmonÃ« horizontale */
      gap:16px 16px;
      align-items:start;
    }

    h2{ margin: 0; font-size: 26px; grid-column: 1 / -1; }
    p.lead{ margin:6px 0 16px; color:var(--muted); grid-column:1 / -1; }

    label{ display:block; font-size:14px; margin-bottom:8px; color:#3b3f36; font-weight:600; }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    textarea,
    input[type="file"]{
      width:100%;
      padding:12px 12px;
      border:1.5px solid var(--stroke);
      border-radius: var(--radius);
      background:#fff;
      font-size:14px;
      transition:border .2s ease, box-shadow .2s ease, background .2s ease;
    }
    input:focus, textarea:focus{
      outline:none;
      border-color: var(--accent-2);
      box-shadow: 0 0 0 4px rgba(206,217,152,.28);
      background:#fcfff6;
    }
    textarea{ min-height:120px; resize:vertical; }

    .help{ font-size:12px; color:var(--muted); margin-top:6px; }

    .field{ display:flex; flex-direction:column; gap:6px; }
    .field.span-2{ grid-column: 1 / -1; }       /* elemente qÃ« shtrihen nÃ« tÃ« dy kolonat */
    .field.inline{ display:flex; align-items:center; gap:10px; }

    .actions{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
    button{
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color:#24310b; border:0; border-radius:999px;
      padding:12px 18px; font-weight:700; font-size:15px; cursor:pointer;
      transition: filter .2s ease, transform .1s ease;
      box-shadow: 0 8px 20px rgba(110,130,20,.20);
    }
    button:hover{ filter:brightness(1.05); }
    button:active{ transform: translateY(1px); }
    button[disabled]{ opacity:.6; cursor:not-allowed; }

    .status{ font-size:14px; color: var(--muted); }

    .banner{
      display:none; margin-top:8px; padding:12px 14px; border-radius:12px; border:1px solid;
    }
    .banner.show{ display:block; }
    .banner.ok{ background:#f0f9eb; border-color:#cce3b0; color:#305419; }
    .banner.err{ background:#fff3f3; border-color:#f3c2c2; color:#7a2c2c; }

    .captcha-wrap{ margin: 6px 0 0; }  /* spacing i reCAPTCHA-s */

    /* gjendje gabimi tek fusha */
    .invalid{ border-color:#f1a7a7 !important; background:#fff8f8; }
    .error{ font-size:12px; color:#7a2c2c; display:none; }
  </style>
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
  <form id="contact-form" novalidate>
    <h2>Na shkruani</h2>
    <p class="lead">PlotÃ«soni formularin dhe do tâ€™ju kontaktojmÃ« sa mÃ« shpejt.</p>

    <div class="field">
      <label for="firstName">Emri</label>
      <input type="text" id="firstName" name="firstName" placeholder="Shkruani emrin" autocomplete="given-name" required />
      <div class="error" id="err-firstName"></div>
    </div>

    <div class="field">
      <label for="lastName">Mbiemri</label>
      <input type="text" id="lastName" name="lastName" placeholder="Shkruani mbiemrin" autocomplete="family-name" required />
      <div class="error" id="err-lastName"></div>
    </div>

    <div class="field">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="emri@shembull.com" inputmode="email" autocomplete="email" required />
      <div class="help">Email-i pÃ«rdoret vetÃ«m pÃ«r tâ€™ju kthyer pÃ«rgjigje.</div>
      <div class="error" id="err-email"></div>
    </div>

    <div class="field">
      <label for="phone">Telefoni (opsional)</label>
      <input type="tel" id="phone" name="phone" placeholder="+355 ..." autocomplete="tel" />
      <div class="error" id="err-phone"></div>
    </div>

    <div class="field span-2">
      <label for="message">Mesazhi juaj</label>
      <textarea id="message" name="message" placeholder="Shkruani mesazhin..." required></textarea>
      <div class="error" id="err-message"></div>
    </div>

    <div class="field">
      <label for="cv">Ngarko CV (PDF, deri 5MB)</label>
      <input type="file" id="cv" name="cv" accept="application/pdf" />
      <div class="error" id="err-cv"></div>
    </div>

    <div class="field">
      <label for="motivation">Ngarko LetÃ«r Motivimi (PDF, deri 5MB)</label>
      <input type="file" id="motivation" name="motivation" accept="application/pdf" />
      <div class="error" id="err-motivation"></div>
    </div>

    <div class="field span-2">
      <div class="captcha-wrap">
        <div class="g-recaptcha" data-sitekey="6LfBBporAAAAAA1jbDpwNfQ_fd_6DGKukVmy5ise"></div>
        <div class="error" id="err-captcha"></div>
      </div>
    </div>

    <div class="field span-2">
      <div class="actions">
        <button type="submit" id="submitBtn">DÃ«rgo</button>
        <span class="status" id="status" aria-live="polite"></span>
      </div>
      <div class="banner" id="banner" role="status" aria-live="polite"></div>
    </div>
  </form>

  <script>
    // ðŸ”§ ZÃ‹VENDÃ‹SO me URL-nÃ« e Web App-it tÃ«nd (Deploy > Web app)
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw-NDcRpqhh9v3TgRVRpnGUqLAvvTTc9SrPb62CmVCQUdtgLUIH1-W6IRdDBdybSZws/exec";

    const $ = (sel)=>document.querySelector(sel);
    const form = $("#contact-form");
    const statusEl = $("#status");
    const banner = $("#banner");
    const submitBtn = $("#submitBtn");

    const errors = {
      firstName: $("#err-firstName"),
      lastName: $("#err-lastName"),
      email: $("#err-email"),
      phone: $("#err-phone"),
      message: $("#err-message"),
      cv: $("#err-cv"),
      motivation: $("#err-motivation"),
      captcha: $("#err-captcha"),
    };

    function setStatus(msg){ statusEl.textContent = msg; }
    function showBanner(type,msg){
      banner.className = "banner show " + (type === "ok" ? "ok" : "err");
      banner.textContent = msg;
    }
    function disableForm(disabled){ submitBtn.disabled = disabled; }

    function clearFieldError(field){
      errors[field].style.display = "none";
      const el = form[field] || document.getElementById(field);
      if(el) el.classList.remove("invalid");
    }
    function setFieldError(field,msg){
      const el = form[field] || document.getElementById(field);
      if(el) el.classList.add("invalid");
      errors[field].textContent = msg;
      errors[field].style.display = "block";
    }
    function resetUI(){
      setStatus("");
      banner.className = "banner";
      banner.textContent = "";
      Object.keys(errors).forEach(clearFieldError);
    }

    // Lexim PDF nÃ« base64 (pa prefix-in data:)
    function toBase64(file){
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => {
          const s = String(reader.result);
          resolve(s.includes(",") ? s.split(",")[1] : "");
        };
        reader.onerror = reject;
      });
    }

    // Regex email konservative (pa false-negative tÃ« zakonshme)
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;

    ["firstName","lastName","email","message","phone"].forEach(id=>{
      const el = document.getElementById(id);
      if(!el) return;
      el.addEventListener("input", ()=> clearFieldError(id));
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      resetUI();

      let ok = true;

      if(!form.firstName.value.trim()){ setFieldError("firstName","Shkruani emrin."); ok = false; }
      if(!form.lastName.value.trim()){ setFieldError("lastName","Shkruani mbiemrin."); ok = false; }

      const emailVal = form.email.value.trim();
      if(!emailVal){ setFieldError("email","Shkruani email-in."); ok = false; }
      else if(!emailRegex.test(emailVal)){ setFieldError("email","Email i pavlefshÃ«m."); ok = false; }

      const phoneVal = form.phone.value.trim();
      if(phoneVal && !/^\+?\d[\d\s\-()]{5,}$/.test(phoneVal)){
        setFieldError("phone","Formati i telefonit duket i pasaktÃ«."); ok = false;
      }

      if(!form.message.value.trim()){ setFieldError("message","Shkruani mesazhin."); ok = false; }

      const token = (window.grecaptcha && grecaptcha.getResponse()) || "";
      if(!token){ setFieldError("captcha","Ju lutemi plotÃ«soni reCAPTCHA-n."); ok = false; }

      // SkedarÃ«t (opsionalÃ«) + kufiri 5MB
      const cvFile = document.getElementById("cv").files[0];
      const motivationFile = document.getElementById("motivation").files[0];
      const MAX = 5 * 1024 * 1024;

      if (cvFile && cvFile.size > MAX){ setFieldError("cv","CV Ã«shtÃ« mÃ« e madhe se 5MB."); ok = false; }
      if (motivationFile && motivationFile.size > MAX){ setFieldError("motivation","Letra e motivimit Ã«shtÃ« mÃ« e madhe se 5MB."); ok = false; }

      if(!ok) return;

      let cvBase64 = "", motivationBase64 = "";
      try{
        if (cvFile) cvBase64 = await toBase64(cvFile);
        if (motivationFile) motivationBase64 = await toBase64(motivationFile);
      }catch(err){
        setFieldError("cv","Nuk u lexuan skedarÃ«t PDF."); return;
      }

      try{
        disableForm(true);
        setStatus("Duke u dÃ«rguarâ€¦");

        const payload = new URLSearchParams({
          firstName: form.firstName.value.trim(),
          lastName:  form.lastName.value.trim(),
          email:     emailVal,
          phone:     phoneVal,
          message:   form.message.value.trim(),
          cvBase64,
          motivationBase64,
          token
        });

        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" },
          body: payload.toString()
        });

        const text = await res.text();

        if(res.ok){
          form.reset();
          if(window.grecaptcha) grecaptcha.reset();
          showBanner("ok", text || "Mesazhi u dÃ«rgua me sukses.");
        } else {
          showBanner("err", text || "Ndodhi njÃ« gabim gjatÃ« dÃ«rgimit.");
        }
      }catch(err){
        showBanner("err", "Gabim rrjeti: " + err.message);
      }finally{
        setStatus("");
        disableForm(false);
      }
    });
  </script>
</body>
</html>
